商品編集ページ
= stylesheet_link_tag 'items_edit'

.pagecontainer
  -# ヘッダー
  %header.pagecontainer__header
    =link_to image_tag('logo/logo.png', alt: "ロゴ画像", class:"logolink__image"), root_path, class: "logolink"



  %main.pagecontainer__main
    .flashbox
      = flash[:itemnotice]  
    %h1.mainh1 商品登録ページ
    = form_for(@item, url: item_path) do |f|

      -# .field
      -#   = f.label :出品画像（１０枚まで）, class:"field__formlabel"
      -#   %span.field__formspan 必須
      -#   %br/
      -#   #image-box
      -#     #previews
      -#       - if @item.persisted?
      -#         - @item.images.each_with_index do |images, i|
      -#           = image_tag images.image.url, data: { index: i }, width: "100", height: '100'
      -#     = f.fields_for :images do |image|
      -#       .js-file_group{"data-index" => "#{image.index}"}
      -#         %i.fas.fa-camera 画像1
      -#         = image.file_field :image, class:"js-file"
      -#         %strong.js-remove 削除 
      -#         - if @item.persisted?
      -#           = image.check_box :_destroy, data:{ index: image.index }, class: 'hidden-destroy'

      -#     - if @item.persisted?
      -#       .js-file_group{"data-index" => "#{@item.images.count}"}
      -#         =file_field_tag :image, name: "item[images_attributes][#{@item.images.count}][image]", class:'js-file'
      -#         .js-remove 削除


      .field
        = f.label :商品名, class:"field__formlabel"
        %span.field__formspan 必須
        %br/
        = f.text_field :name, class:"field__forminput", placeholder: "40文字まで"
      
      .field
        = f.label :商品説明, class:"field__formlabel"
        %span.field__formspan 必須
        %br/
        = f.text_area :description, class:"field__textarea", size:'20x10', placeholder: "1000文字まで"

      .field
        = f.label :ブランド, class:"field__formlabel"
        %span.field__formspan 任意
        %br/
        = f.text_field :brand, class:"field__forminput", :placeholder => "例)シャネル"


      .listing-form-box
        .listing-product-detail__category
          = f.label 'カテゴリー', class: 'listing-default__label'
          %span.listing-default--require 必須
          .listing-select-wrapper            
            = f.select :parentcategory, @category_parent_array, {}, {class: 'listing-select-wrapper__box--select', id: 'parent_category'}
          -# とりあえず親のセレクトは登録された値入りで表示されることは確認したので、フォームのロジックはそのままにしてフィールドを最初から表示しとくか
          -# jsで組み立ててあるセレクトのフィールドを最初から表示させときゃ何とかなるか？
          -# 子
          -# <div class='listing-select-wrapper__added' id= 'children_wrapper'>                        
          -#   <select class="listing-select-wrapper__box--select" id="child_category" name="item[childcategory]">
          -#     <option value="---" data-category="---">---</option>
          -#     ${insertHTML}
                  insertHTMLにvalue入りのオプション並べる感じ。下のをforeachで並べる的な
                  <option value="${category.id}" data-category="${category.id}">${category.name}</option>
          -#   <select>                                                 
          -# </div>
          -# 孫
            <div class='listing-select-wrapper__added' id= 'grandchildren_wrapper'>                            
                <select class="listing-select-wrapper__box--select" id="grandchild_category" name="item[category_id]">
                  <option value="---" data-category="---">---</option>
                  ${insertHTML}
                </select>                                                           
            </div>`;
          -# これは一応表示ができるけどjsうまく動かん
          #children_wrapper.listing-select-wrapper__added
            -# = f.select :childcategory, @editpage_category_children, {}, {class: 'listing-select-wrapper__box--select', id: 'child_category'}
              -# = collection_select オブジェクト名, プロパティ名, オブジェクトの配列, value属性にセットしたいオブジェクトの属性, 表示に使用するオブジェクトの属性
            = f.collection_select :childcategory, @editpage_category_children, :id, :name
          #grandchildren_wrapper.listing-select-wrapper__added
            = f.collection_select :category_id, @editpage_category_grandchildren, :id, :name
          -# さらなる実験記述
          -# #grandchildren_wrapper.listing-select-wrapper__added
          -#   %select#grandchild_category.listing-select-wrapper__box--select{:name => "item[category_id]"}
          -#     %option{"data-category" => "---", :value => "---"} ---

          
      
      .field
        = f.label :発送元の地域, class:"field__formlabel"
        = f.select :delivery_from, Item.delivery_froms.keys, prompt: '---', class:"decoratedselect"
        %span.field__formspan 必須
        %br/
        

      .field
        = f.label :商品の状態, class:"field__formlabel"
        %span.field__formspan 必須
        %br/
        = f.collection_select :condition_id, Condition.all, :id, :name, {:include_blank => true}, class:"decoratedselect"
        %i.fas.fa-chevron-down.decoratedchevron

      .field
        = f.label :商品のサイズ, class:"field__formlabel"
        %span.field__formspan 必須
        %br/
        = f.collection_select :size_id, Size.all, :id, :name, {:include_blank => true}, class:"decoratedselect"
        %i.fas.fa-chevron-down.decoratedchevron

      .field
        = f.label :配送料の負担, class:"field__formlabel"
        %span.field__formspan 必須
        %br/
        = f.collection_select :deliverycost_id, Deliverycost.all, :id, :name, {:include_blank => true}, class:"decoratedselect"
        %i.fas.fa-chevron-down.decoratedchevron

      .field
        = f.label :配送の方法, class:"field__formlabel"
        %span.field__formspan 必須
        %br/
        = f.collection_select :deliveryway_id, Deliveryway.all, :id, :name, {:include_blank => true}, class:"decoratedselect"
        %i.fas.fa-chevron-down.decoratedchevron

      .field
        = f.label :発送までの日数, class:"field__formlabel"
        %span.field__formspan 必須
        %br/
        = f.collection_select :deliverytime_id, Deliverytime.all, :id, :name, {:include_blank => true}, class:"decoratedselect"
        %i.fas.fa-chevron-down.decoratedchevron
      
      .field
        = f.label :販売価格（￥３００〜￥９９９９９９９）, class:"field__formlabel"
        %span.field__formspan 必須
        %br/
        = f.number_field :price, class:"field__forminput"
      
      .field
        = f.hidden_field :user_id, :value => current_user.id

      %br/
      .actions
        = f.submit "更新する", id:"itembtn"
  -# フッター
  = render partial:'devise/registrations/footer'
